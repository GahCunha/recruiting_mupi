{% extends "base.html" %}
{% block title %}Mensagens{% endblock %}
{% block content %}
  <h1>Mensagens</h1>

  {% if mensagens %}
    <ul>
      {% for m in mensagens %}
        <li>
          <a href="{% url 'message_detail' m.pk %}">
            {{ m.nome }} — {{ m.email }}
          </a>

          {% include "partials/message_status.html" with m=m %}

          <button
            type="button"
            hx-post="{% url 'message_toggle_read' m.pk %}"
            hx-target="#status-{{ m.pk }}"
            hx-swap="outerHTML"
          >
            Alternar lido
          </button>

          <small>— {{ m.data_envio }}</small>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Nenhuma mensagem ainda.</p>
  {% endif %}

  <form action="{% url 'logout_confirm' %}" method="get">
    <button type="submit">Sair</button>
  </form>
{% endblock %}
